provider "aws" {
  region = "eu-west-1"
}

terraform {
  required_providers {
    kubectl = {
      source  = "gavinbunney/kubectl"
      version = ">= 1.14.0"
    }
    helm = {
      source  = "hashicorp/helm"
      version = ">= 2.6.0"
    }
  }

  required_version = "~> 1.0"
}

provider "kubectl" {
  host                   = "https://DDF99D1BD744231F8A2AEC10F71C4D67.gr7.eu-west-1.eks.amazonaws.com" 
  cluster_ca_certificate = base64decode("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMvakNDQWVhZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJek1EZ3lOekUyTXpRek1Wb1hEVE16TURneU5ERTJNelF6TVZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTWhDCkdULzRNb2JyRWJwOElXRTRzY3ZXTEtzQmhoODFZc3FzUmdQdnpqOGtCMkloOCtvdmIzTHVaaStIKy9sOWRWZVMKb3BsTEdXeVRYdStSbFUyMWp4eDZWc09YM1ZXOUhjM0FwS3RwZ1pBZzFlT0dxaE1OL3dCVTNBWUUzTXFjTktuYQp5RmlUUmtIbDBqQlJncDZxYnBaMXJkOVQ1bFVOeUp4QzIwdmxLQUh2Vm1Mc1p5Ky9nTGZPbmdvR05Gb3RsZmduCmF3TWNTL2JSOWVjQzFkaXJka2UxaUZZRXhrcW43RlZvNGFsRi93SGF1QzJHUGZqZHBOaUhkN1JoNnhJTHRuTEIKUjlIRzRzbFp0d0FPQWFlajRmWlI2eTJpSjczd2dGV1YwOW4vZUNiTmxoMm4wY2diRHVpQ0VDb0dBcHFNUGJTOApza2JVUzBvaW90V2lNQWFXYzFVQ0F3RUFBYU5aTUZjd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZJMlB6Qnc1TEl5NEloSWdkWlNsMzdTSUFjYnVNQlVHQTFVZEVRUU8KTUF5Q0NtdDFZbVZ5Ym1WMFpYTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBTVh0VlVWV2FSUy95S3RQSzQzaQpkK1dKLzFtNC95a2tOVEkydWFlK1VVNUVCSFpDOEw5djZUc1RSQTA2SlRzUXVVMHk4TlgxK2pSaEJQeVhrV3FHCjM3Q3YrTDNzWitjK293dnN0OEtGaStCVmF6ZDRGY2c3S0xwVjFwZjIvOUg1dmxVZWhFRXBjV2tHWFB2Z2xPYXcKQzg1ejhWOTB3THoyYWZPTUV3dHlERThlTDQ2d1BIa1JyTElDUm9vMEZ0dU9VQVRHclJ6N1ZldVVNV0hVUy9ScgpXNlNsUW5VNXBhVC9zR3RLMGwrSDdTNTRINmk3cTZIc2VQSTdGTnAvS0ZySG9HQUlHWUlIdFBDdEFFYzlIK1dmCjFRR0ZGUTlZNlVLSG1OL2htcGV2b1FhSjVnTFYxWEIybkcvUTNMQ000Uk4zM3BreWZuUy9hNTlCQjVCcUp5UFkKU2R3PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==")
  load_config_file       = false

  exec {
    api_version = "client.authentication.k8s.io/v1beta1"
    args        = ["eks", "get-token", "--cluster-name", "techoutcomes"]
    command     = "aws"
  }
}
